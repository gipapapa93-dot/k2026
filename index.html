<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>개인파산 신청자격 자가진단</title>

  <style>
    :root { --bg:#0b1220; --card:#121a2b; --text:#e9eefc; --muted:#a9b5d1; --accent:#4dd6ff; }
    * { box-sizing: border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif;
      background: radial-gradient(1200px 800px at 20% 0%, #132042 0%, var(--bg) 55%, #050811 100%);
      color: var(--text);
      min-height:100vh;
      padding:24px;
      display:flex;
      justify-content:center;
      align-items:flex-start;
    }
    .app{ width:min(920px,100%); }
    h1{ margin:0 0 6px; font-size:20px; }
    .sub{ margin:0 0 16px; color:var(--muted); font-size:13px; line-height:1.5; }

    /* ✅ color-mix 제거: 호환성 최우선 */
    .card{
      background: var(--card);
      border:1px solid rgba(255,255,255,.10);
      border-radius:18px;
      padding:18px;
      box-shadow: 0 20px 80px rgba(0,0,0,.45);
    }

    .topline{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      margin-bottom:10px;
    }
    .pill{
      font-size:12px;
      color: var(--muted);
      padding:6px 10px;
      border:1px solid rgba(255,255,255,.12);
      border-radius:999px;
      background: rgba(0,0,0,.25);
    }

    .progress{ height:10px; background:rgba(255,255,255,.10); border-radius:999px; overflow:hidden; border:1px solid rgba(255,255,255,.10); }
    .bar{ height:100%; width:0%; background: linear-gradient(90deg, var(--accent), #7cffd9); transition: width .25s ease; }

    .qtitle{ font-size:18px; margin:14px 0 10px; letter-spacing:-.2px; }
    .qdesc{ margin:0 0 14px; color:var(--muted); font-size:13px; line-height:1.55; }

    .row{
      padding:12px;
      border:1px solid rgba(255,255,255,.12);
      border-radius:14px;
      background: rgba(255,255,255,.03);
    }
    .toggle{ display:flex; gap:10px; flex-wrap:wrap; }
    .chip{
      user-select:none;
      padding:9px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      cursor:pointer;
      font-size:13px;
      color:var(--text);
    }
    .chip.on{ border-color: rgba(77,214,255,0.70); background: rgba(77,214,255,0.18); }

    .btns{ display:flex; gap:10px; justify-content:space-between; margin-top:14px; flex-wrap:wrap; }
    button{
      padding:11px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.08);
      color:var(--text);
      cursor:pointer;
      font-weight:700;
    }
    button.primary{ background: linear-gradient(90deg, rgba(77,214,255,0.30), rgba(124,255,217,0.22)); border-color: rgba(77,214,255,0.40); }
    button:disabled{ opacity:.5; cursor:not-allowed; }

    .err{ color:#ffd1d9; font-size:12px; margin-top:10px; display:none; }

    .result{ display:none; margin-top:16px; border-top:1px solid rgba(255,255,255,.12); padding-top:14px; }
    .badge{ padding:10px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); margin-bottom:10px; }
    .badge .k{ color:var(--muted); font-size:12px; margin-bottom:6px; }
    .badge .v{ font-size:18px; font-weight:900; letter-spacing:-.2px; }
    .hintList{ margin:12px 0 0; padding-left:18px; color:var(--muted); }
    .small{ font-size:12px; color:var(--muted); margin-top:8px; line-height:1.55; }

    label{ font-size:13px; color:var(--muted); display:block; margin-bottom:8px; }
    input, textarea{
      width:100%;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.28);
      color:var(--text);
      outline:none;
    }
    textarea{ min-height:92px; resize:vertical; }
  </style>
</head>

<body>
  <div class="app">
    <h1>개인파산 신청자격 자가진단</h1>
    <p class="sub">간단한 질문으로 “가능성(참고용)”을 확인합니다. 최종 판단은 사건별 사정/법원 실무에 따라 달라질 수 있어요.</p>

    <div class="card">
      <div class="topline">
        <div class="pill" id="statusPill">로딩중…</div>
        <div class="pill"><span id="stepText">1</span> / <span id="totalText">5</span></div>
      </div>

      <div class="progress"><div class="bar" id="bar"></div></div>

      <div id="questionArea"></div>
      <div class="err" id="errBox">예/아니오를 선택해 주세요.</div>

      <div class="btns">
        <button id="backBtn">이전</button>
        <button id="nextBtn" class="primary">다음</button>
      </div>

      <div class="result" id="resultArea">
        <div class="qtitle">진단 결과</div>
        <p class="qdesc" id="resultDesc"></p>

        <div class="badge">
          <div class="k">종합 판단(참고용)</div>
          <div class="v" id="levelText">-</div>
        </div>
        <div class="badge">
          <div class="k">점수</div>
          <div class="v" id="scoreText">-</div>
        </div>

        <ul class="hintList" id="hints"></ul>

        <div style="height:1px;background:rgba(255,255,255,.12);margin:14px 0;"></div>

        <div class="qtitle" style="margin-top:0;">상담 신청</div>
        <p class="qdesc">이름/전화번호를 남기면 메일 작성창이 열리고 상담 신청 내용이 자동으로 채워집니다.</p>

        <div class="row" style="margin-bottom:12px;">
          <label>이름</label>
          <input id="lead_name" type="text" placeholder="예: 홍길동">
        </div>
        <div class="row" style="margin-bottom:12px;">
          <label>전화번호</label>
          <input id="lead_phone" type="tel" inputmode="tel" placeholder="예: 01012345678">
          <div class="small">하이픈(-) 없이 입력해도 됩니다.</div>
        </div>
        <div class="row">
          <label>메모(선택)</label>
          <textarea id="lead_memo" placeholder="예: 월소득 180만원, 부양 2명, 통장압류 등"></textarea>
        </div>

        <div class="btns" style="margin-top:12px;">
          <button id="sendEmailBtn" class="primary">이메일로 상담신청 보내기</button>
          <button id="restartBtn">처음부터 다시</button>
        </div>
      </div>
    </div>
  </div>

<script>
  // ✅ 반드시 script가 정상 실행되는지 표시
  document.getElementById("statusPill").textContent = "실행됨";

  const OWNER_EMAIL = "dlion1993@naver.com";

  const steps = [
    { title:"1) 현재 상환이 사실상 불가능한 상태인가요?", desc:"연체 중이거나 정상 상환을 지속하기 어려운 상태인지 확인합니다.", yes:+18, no:-25 },
    { title:"2) 총 채무가 비교적 큰 편인가요?", desc:"채무 규모가 클수록 파산 검토 빈도가 높아집니다(참고용).", yes:+10, no:-2 },
    { title:"3) 최근 월소득이 낮거나 거의 없나요?", desc:"무소득 또는 저소득이면 파산 검토 가능성이 올라갑니다.", yes:+8, no:-3 },
    { title:"4) 보유 재산이 거의 없나요?", desc:"재산이 크면 환가/배당 이슈가 커질 수 있어요.", yes:+6, no:-6 },
    { title:"5) 최근 1년 내 편파변제/재산처분 이력이 없나요?", desc:"있다면 ‘소명’이 중요해질 수 있어요.", yes:+4, no:-10 }
  ];

  const state = {
    step: 0,
    answers: Array(steps.length).fill(null), // "yes" | "no" | null
    score: 50
  };

  const $ = (id) => document.getElementById(id);

  $("totalText").textContent = String(steps.length);

  function clamp(n,min,max){ return Math.max(min, Math.min(max, n)); }

  function setErr(show){
    $("errBox").style.display = show ? "block" : "none";
  }

  function recalcScore(){
    let s = 50;
    for (let i=0;i<steps.length;i++){
      const a = state.answers[i];
      if (a === "yes") s += steps[i].yes;
      else if (a === "no") s += steps[i].no;
    }
    state.score = clamp(Math.round(s), 0, 100);
  }

  function renderStep(){
    setErr(false);

    $("stepText").textContent = String(Math.min(state.step + 1, steps.length));
    $("bar").style.width = `${Math.round((state.step / steps.length) * 100)}%`;

    $("resultArea").style.display = "none";
    $("backBtn").style.display = "inline-block";
    $("nextBtn").style.display = "inline-block";

    if (state.step >= steps.length) {
      showResult();
      return;
    }

    const q = steps[state.step];
    const picked = state.answers[state.step];

    $("questionArea").innerHTML = `
      <div class="qtitle">${q.title}</div>
      <p class="qdesc">${q.desc}</p>
      <div class="row">
        <div class="toggle">
          <span class="chip ${picked==="yes" ? "on" : ""}" data-choice="yes">예</span>
          <span class="chip ${picked==="no" ? "on" : ""}" data-choice="no">아니오</span>
        </div>
        <div class="small">예/아니오를 선택한 뒤 “다음”을 눌러주세요.</div>
      </div>
    `;

    document.querySelectorAll("[data-choice]").forEach(el => {
      el.addEventListener("click", () => {
        state.answers[state.step] = el.getAttribute("data-choice");
        renderStep();
      });
    });

    $("backBtn").disabled = (state.step === 0);
    $("nextBtn").textContent = (state.step === steps.length - 1) ? "결과 보기" : "다음";
  }

  function showResult(){
    recalcScore();

    $("bar").style.width = "100%";
    $("questionArea").innerHTML = "";
    $("backBtn").style.display = "none";
    $("nextBtn").style.display = "none";
    $("resultArea").style.display = "block";

    let level = "다른 제도 우선 검토";
    let desc  = "현재 입력 기준으로는 파산보다는 회생/채무조정 등 비교 검토가 필요할 수 있어요.";
    if (state.score >= 75) { level="개인파산 가능성 높음(참고용)"; desc="입력 기준으로는 개인파산 검토 우선순위가 높은 편입니다."; }
    else if (state.score >= 55) { level="개인파산 가능성 보통(참고용)"; desc="개인파산도 가능하지만 회생/채무조정과 비교 검토가 필요한 구간입니다."; }

    $("levelText").textContent = level;
    $("scoreText").textContent = `${state.score} 점`;
    $("resultDesc").textContent = desc;

    const hints = [];
    if (state.answers[4] === "no") hints.push("최근 편파변제/재산처분이 있다면 사용처·사유 정리(소명)가 핵심입니다.");
    hints.push("이 결과는 ‘상담 전 자가진단’용입니다. 사건별로 결론이 달라질 수 있어요.");
    $("hints").innerHTML = hints.map(x => `<li>${x}</li>`).join("");
  }

  function normalizePhone(p){ return String(p||"").replace(/[^0-9]/g, ""); }
  function openMailto(to, subject, body){
    const cleanTo = String(to||"").trim().replace(/[<>]/g,"").replace(/\s+/g,"").replace(/;+$/g,"");
    location.href = `mailto:${cleanTo}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
  }

  $("backBtn").addEventListener("click", () => {
    if (state.step > 0) {
      state.step--;
      renderStep();
    }
  });

  $("nextBtn").addEventListener("click", () => {
    if (state.step >= steps.length) return;

    const a = state.answers[state.step];
    if (a !== "yes" && a !== "no") {
      setErr(true);
      return;
    }
    state.step++;
    renderStep();
  });

  $("sendEmailBtn").addEventListener("click", () => {
    const name = String($("lead_name").value||"").trim();
    const phone = normalizePhone($("lead_phone").value);
    const memo = String($("lead_memo").value||"").trim();

    if (!name) return alert("이름을 입력해 주세요.");
    if (phone.length < 9) return alert("전화번호를 정확히 입력해 주세요.");

    const subject = `[개인파산 상담신청] ${name} / ${phone}`;
    const bodyLines = [
      "[개인파산 상담 요청]",
      `이름: ${name}`,
      `전화: ${phone}`,
      memo ? `메모: ${memo}` : "",
      "",
      "[자가진단 요약]",
      `점수: ${state.score}점`,
      `응답: ${state.answers.map((x,i)=>`${i+1}번 ${x==="yes"?"예":"아니오"}`).join(", ")}`
    ].filter(Boolean);

    alert("메일 작성창이 열립니다. 내용 확인 후 ‘전송’을 눌러야 접수됩니다.");
    openMailto(OWNER_EMAIL, subject, bodyLines.join("\n"));
  });

  $("restartBtn").addEventListener("click", () => {
    state.step = 0;
    state.answers = Array(steps.length).fill(null);
    state.score = 50;
    $("lead_name").value = "";
    $("lead_phone").value = "";
    $("lead_memo").value = "";
    renderStep();
  });

  // ✅ 첫 렌더
  renderStep();
</script>
</body>
</html>
